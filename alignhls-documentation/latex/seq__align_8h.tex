\doxysection{increment/include/seq\+\_\+align.h File Reference}
\hypertarget{seq__align_8h}{}\label{seq__align_8h}\index{increment/include/seq\_align.h@{increment/include/seq\_align.h}}


This file contains codes for align functions.  


{\ttfamily \#include $<$ap\+\_\+int.\+h$>$}\newline
{\ttfamily \#include $<$hls\+\_\+task.\+h$>$}\newline
{\ttfamily \#include $<$hls\+\_\+vector.\+h$>$}\newline
{\ttfamily \#include $<$hls\+\_\+stream.\+h$>$}\newline
{\ttfamily \#include $<$hls\+\_\+streamofblocks.\+h$>$}\newline
{\ttfamily \#include "{}./params.\+h"{}}\newline
{\ttfamily \#include "{}./\+PE.\+h"{}}\newline
{\ttfamily \#include "{}./utils.\+h"{}}\newline
{\ttfamily \#include "{}./initial.\+h"{}}\newline
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespaceAlign}{Align}}
\item 
namespace \mbox{\hyperlink{namespaceAlign_1_1FindMax}{Align\+::\+Find\+Max}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{seq__align_8h_a76b44c4299f98b78c420f98497d478e4}{align\+\_\+wp}} (hls\+::stream$<$ \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}, \mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}} $>$ \&query\+\_\+stream, hls\+::stream$<$ \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}, \mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}} $>$ \&reference\+\_\+stream, hls\+::stream$<$ hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$, \mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}} $>$ \&init\+\_\+qry\+\_\+scr, hls\+::stream$<$ hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$, \mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}} $>$ \&init\+\_\+ref\+\_\+scr, hls\+::stream$<$ \mbox{\hyperlink{params_8h_af01971f7c8dd670620c681062e49a238}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}+\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}} $>$ \&traceback\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_a57bde59190c2570050f6ed9e3041d8c3}{Align\+::\+Prepare\+Local\+Query}} (\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&query)\mbox{[}\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&local\+\_\+query)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} offset, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} len)
\begin{DoxyCompactList}\small\item\em Copy PE\+\_\+\+NUM number of query values to the local query buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_a7cbd554ea3395dc97f0255277f885f17}{Align\+::\+DPMem\+Update\+Block}} (hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+in, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&score\+\_\+in, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_af119b9ad38057b15d433eb269ef1cda3}{Align\+::\+DPMem\+Update\+Arr}} (\mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} \&dp\+\_\+mem\+\_\+in, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&score\+\_\+in)
\item 
void \mbox{\hyperlink{namespaceAlign_af54cccdb98b3f84f0bd2b9baef141568}{Align\+::\+Initialize\+Chunk\+Col\+Score}} (\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_acf68c99ac0164bdebf1c6c2f0c44a32b}{Align\+::\+Prepare\+Scores\+Block}} (hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+in, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, int id, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}\mbox{[}2\mbox{]}$>$ \&last\+\_\+chunk\+\_\+scr, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&up\+\_\+out, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&diag\+\_\+out, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&left\+\_\+out, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+out)
\begin{DoxyCompactList}\small\item\em Prepare blocks of left, up, an diagonal scores for Expand\+Compute\+Block function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_adfd9ea4e4f4a3a398239fb53c3f0d574}{Align\+::\+Prepare\+Scores\+Arr}} (\mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} \&dp\+\_\+mem\+\_\+in, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, int id, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&last\+\_\+chunk\+\_\+scr)\mbox{[}2\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&up\+\_\+out, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&diag\+\_\+out, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&left\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_a6450dede9f914eca05a4696f9112dec9}{Align\+::\+Chunk\+Compute\+SoB}} (\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} chunk\+\_\+row\+\_\+offset, \mbox{\hyperlink{params_8h_aae0a4301a15974d8514ee65bcd2f78c5}{input\+\_\+char\+\_\+block\+\_\+t}} \&query, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&reference)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&init\+\_\+col\+\_\+scr, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&init\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, int query\+\_\+length, int reference\+\_\+length, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&preserved\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{structScorePack}{Score\+Pack}} \&max, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a8854489712fb75ea94b397f9807499f2}{tbp\+\_\+chunk\+\_\+block\+\_\+t}} $>$ \&chunk\+\_\+tbp\+\_\+out)
\begin{DoxyCompactList}\small\item\em Compute a chunk of the alignment matrix. Output the chunk traceback pointers. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_afe3f00c99ed1b663dc7334b86ec612fe}{Align\+::\+Chunk\+Compute}} (\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} chunk\+\_\+row\+\_\+offset, \mbox{\hyperlink{params_8h_aae0a4301a15974d8514ee65bcd2f78c5}{input\+\_\+char\+\_\+block\+\_\+t}} \&query, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&reference)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&init\+\_\+col\+\_\+scr, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&init\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, int query\+\_\+length, int reference\+\_\+length, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&preserved\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{structScorePack}{Score\+Pack}} \&max, \mbox{\hyperlink{params_8h_af01971f7c8dd670620c681062e49a238}{tbp\+\_\+t}}(\texorpdfstring{$\ast$}{*}chunk\+\_\+tbp\+\_\+out)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Compute the traceback pointers for a chunk of the size PE\+\_\+\+NUM \texorpdfstring{$\ast$}{*} REFERENCE\+\_\+\+LENGTH. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_af7f2171dda71f8dfed5e8d74fadd7357}{Align\+::\+Write\+Initial\+Col\+Score}} (int i, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+scores)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+in, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&scores\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_a8d0a95360406020075f4199acd400897}{Align\+::\+Arrange\+TBPBlock}} (hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a9eb838767f86a3762daa205823af9517}{tbp\+\_\+block\+\_\+t}} $>$ \&tbp\+\_\+in, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a8854489712fb75ea94b397f9807499f2}{tbp\+\_\+chunk\+\_\+block\+\_\+t}} $>$ \&tbp\+\_\+chunk\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_a916f10ccd010b94a65794dd8f778dd0e}{Align\+::\+Arrange\+TBPArr}} (\mbox{\hyperlink{params_8h_a9eb838767f86a3762daa205823af9517}{tbp\+\_\+block\+\_\+t}} \&tbp\+\_\+in, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_af01971f7c8dd670620c681062e49a238}{tbp\+\_\+t}}(\texorpdfstring{$\ast$}{*}chunk\+\_\+tbp\+\_\+out)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_a304682b6f53cdf1158928d8aa253248b}{Align\+::\+Shift\+Predicate}} (bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, int idx, int query\+\_\+len, int reference\+\_\+len)
\item 
void \mbox{\hyperlink{namespaceAlign_afb3d6ba48368d71c9a9b913f6250d458}{Align\+::\+Shift\+Referece}} (\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&local\+\_\+reference)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&reference)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, int idx, int ref\+\_\+len)
\item 
void \mbox{\hyperlink{namespaceAlign_a8a8c293ec21ce1c762d45f0b20a587ea}{Align\+::\+Preserve\+Row\+Score}} (hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&preserved\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&scores, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_1_1FindMax_ab2634436f46741c9a5f027bf3238801a}{Align\+::\+Find\+Max\+::\+Update\+PEMaximum}} (\mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}(\&new\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{structScorePack}{Score\+Pack}}(\&max)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offsets)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} chunk\+\_\+offset, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_1_1FindMax_aff2228f04fe7f30946256045ca7c7ce3}{Align\+::\+Find\+Max\+::\+Extract\+Scores\+Layer}} (\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&scores, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} layer, \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}(\&extracted)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_1_1FindMax_a6ad6db830b72334397e356a3a847e0f0}{Align\+::\+Find\+Max\+::\+Init\+PE}} (\mbox{\hyperlink{structScorePack}{Score\+Pack}}(\&packs)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_1_1FindMax_a0b945e05f4e77473debeabd5bcbe2f3a}{Align\+::\+Find\+Max\+::\+Get\+Chunk\+Max}} (\mbox{\hyperlink{structScorePack}{Score\+Pack}}(\&max)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{structScorePack}{Score\+Pack}} \&chunk\+\_\+max)
\item 
void \mbox{\hyperlink{namespaceAlign_a9deede2ac8fc5fa15499593e816156d0}{Align\+::\+Align\+Static}} (\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&querys)\mbox{[}\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&references)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} query\+\_\+length, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} reference\+\_\+length, \mbox{\hyperlink{params_8h_ae948dbba5f80bacad848ac9b6e17ede2}{tbr\+\_\+t}}(\&tb\+\_\+streams)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}+\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Perform Pairwise alignment for two sequences. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_ae52f8a1e49b3cb69233a7e46c2bc725a}{Align\+::\+Initialize\+Scores}} (\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Initialize initial scores for the first column and row on the device. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_a781303e36556d883c4e05dd7e877a973}{Align\+::\+Chunk\+Max}} (\mbox{\hyperlink{structScorePack}{Score\+Pack}} \&max, \mbox{\hyperlink{structScorePack}{Score\+Pack}} new\+\_\+scr)
\item 
void \mbox{\hyperlink{namespaceAlign_a80fd5bb4d0fa5d05c7e4d18868b7b998}{Align\+::\+Update\+PEOffset}} (\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file contains codes for align functions. 

\begin{DoxyAuthor}{Author}
Yingqi Cao (\href{mailto:yic033@ucsd.edu}{\texttt{ yic033@ucsd.\+edu}}) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2023-\/09-\/25
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2023 
\end{DoxyCopyright}


\doxysubsection{Function Documentation}
\Hypertarget{seq__align_8h_a76b44c4299f98b78c420f98497d478e4}\label{seq__align_8h_a76b44c4299f98b78c420f98497d478e4} 
\index{seq\_align.h@{seq\_align.h}!align\_wp@{align\_wp}}
\index{align\_wp@{align\_wp}!seq\_align.h@{seq\_align.h}}
\doxysubsubsection{\texorpdfstring{align\_wp()}{align\_wp()}}
{\footnotesize\ttfamily void align\+\_\+wp (\begin{DoxyParamCaption}\item[{hls\+::stream$<$ \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}, \mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}} $>$ \&}]{query\+\_\+stream,  }\item[{hls\+::stream$<$ \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}, \mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}} $>$ \&}]{reference\+\_\+stream,  }\item[{hls\+::stream$<$ hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$, \mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}} $>$ \&}]{init\+\_\+qry\+\_\+scr,  }\item[{hls\+::stream$<$ hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$, \mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}} $>$ \&}]{init\+\_\+ref\+\_\+scr,  }\item[{hls\+::stream$<$ \mbox{\hyperlink{params_8h_af01971f7c8dd670620c681062e49a238}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}+\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}} $>$ \&}]{traceback\+\_\+out }\end{DoxyParamCaption})}

