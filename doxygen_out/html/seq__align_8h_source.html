<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>alignHLS: increment/include/seq_align.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">alignHLS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_acef02a866dd78b1b17343d9486a09d1.html">increment</a></li><li class="navelem"><a class="el" href="dir_e0d16949835873a7bca66e3a2430968c.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">seq_align.h</div></div>
</div><!--header-->
<div class="contents">
<a href="seq__align_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#ifndef SEQ_ALIGN_H</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#define SEQ_ALIGN_H</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;ap_int.h&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;hls_task.h&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;hls_vector.h&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;hls_stream.h&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;hls_streamofblocks.h&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="params_8h.html">./params.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="PE_8h.html">./PE.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="utils_8h.html">./utils.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="initial_8h.html">./initial.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">debug.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#endif </span><span class="comment">// DEBUG</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">using namespace </span>hls;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="seq__align_8h.html#a76b44c4299f98b78c420f98497d478e4">   34</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="seq__align_8h.html#a76b44c4299f98b78c420f98497d478e4">align_wp</a>(hls::stream&lt;char_t, MAX_QUERY_LENGTH&gt; &amp;query_stream,</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>              hls::stream&lt;char_t, MAX_REFERENCE_LENGTH&gt; &amp;reference_stream,</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>              hls::stream&lt;hls::vector&lt;type_t, N_LAYERS&gt;, <a class="code hl_define" href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a>&gt; &amp;init_qry_scr,</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>              hls::stream&lt;hls::vector&lt;type_t, N_LAYERS&gt;, <a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>&gt; &amp;init_ref_scr,</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>        <span class="comment">//int query_length, int reference_length,</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>              hls::stream&lt;tbp_t, MAX_REFERENCE_LENGTH + MAX_QUERY_LENGTH&gt; &amp;traceback_out);</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="foldopen" id="foldopen00041" data-start="{" data-end="}">
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="namespaceAlign.html">   41</a></span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceAlign.html">Align</a>{</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a57bde59190c2570050f6ed9e3041d8c3">   50</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a57bde59190c2570050f6ed9e3041d8c3">PrepareLocalQuery</a>(</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;query)[<a class="code hl_define" href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a>],</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;local_query)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>],</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>        <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> offset,</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> len</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    );</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a7cbd554ea3395dc97f0255277f885f17">   57</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a7cbd554ea3395dc97f0255277f885f17">DPMemUpdateBlock</a>(</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        hls::stream_of_blocks&lt;dp_mem_block_t&gt; &amp;dp_mem_in,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>        hls::stream_of_blocks&lt;score_block_t&gt; &amp;score_in,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        hls::stream_of_blocks&lt;dp_mem_block_t&gt; &amp;dp_mem_out</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    );</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno"><a class="line" href="namespaceAlign.html#af119b9ad38057b15d433eb269ef1cda3">   63</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#af119b9ad38057b15d433eb269ef1cda3">DPMemUpdateArr</a>(</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>        <a class="code hl_typedef" href="params_8h.html#ae4f28926330c68480c3d77d49137e189">dp_mem_block_t</a> &amp;dp_mem_in,</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        <a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;score_in</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    );</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="namespaceAlign.html#af54cccdb98b3f84f0bd2b9baef141568">   69</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#af54cccdb98b3f84f0bd2b9baef141568">InitializeChunkColScore</a>(</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        <a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a> (&amp;init_col_scr)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>],</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        stream_of_blocks&lt;dp_mem_block_t&gt; &amp;dp_mem_out</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    );</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno"><a class="line" href="namespaceAlign.html#acf68c99ac0164bdebf1c6c2f0c44a32b">   84</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#acf68c99ac0164bdebf1c6c2f0c44a32b">PrepareScoresBlock</a>(</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        hls::stream_of_blocks&lt;dp_mem_block_t&gt; &amp;dp_mem_in,</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        <a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a> (&amp;init_col_scr)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <span class="keywordtype">int</span> <span class="keywordtype">id</span>, </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        hls::stream_of_blocks&lt;<a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a>[2]&gt; &amp;last_chunk_scr,</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        hls::stream_of_blocks&lt;score_block_t&gt; &amp;up_out,</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        hls::stream_of_blocks&lt;score_block_t&gt; &amp;diag_out,</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        hls::stream_of_blocks&lt;score_block_t&gt; &amp;left_out,</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        hls::stream_of_blocks&lt;dp_mem_block_t&gt; &amp;dp_mem_out</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    );</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno"><a class="line" href="namespaceAlign.html#adfd9ea4e4f4a3a398239fb53c3f0d574">   94</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#adfd9ea4e4f4a3a398239fb53c3f0d574">PrepareScoresArr</a>(</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <a class="code hl_typedef" href="params_8h.html#ae4f28926330c68480c3d77d49137e189">dp_mem_block_t</a> &amp;dp_mem_in,</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        <a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a> (&amp;init_col_scr)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <span class="keywordtype">int</span> <span class="keywordtype">id</span>, </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a> (&amp;last_chunk_scr)[2],</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        <a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;up_out,</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;diag_out,</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        <a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;left_out);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="namespaceAlign.html#add7b97d2ce15372695f3a50937d9ca0e">  112</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#add7b97d2ce15372695f3a50937d9ca0e">ChunkComputeBlock</a>(</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> chunk_row_offset,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <a class="code hl_typedef" href="params_8h.html#aae0a4301a15974d8514ee65bcd2f78c5">input_char_block_t</a> &amp;query,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;reference)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        <a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;init_col_scr,</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        hls::vector&lt;type_t, N_LAYERS&gt; (&amp;init_row_scr)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="keywordtype">int</span> query_length, <span class="keywordtype">int</span> reference_length,</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        hls::vector&lt;type_t, N_LAYERS&gt; (&amp;preserved_row_scr)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <a class="code hl_struct" href="structScorePack.html">ScorePack</a> &amp;max,  <span class="comment">// write out so must pass by reference</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        hls::stream_of_blocks&lt;tbp_chunk_block_t&gt; &amp;chunk_tbp_out</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    );</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="namespaceAlign.html#aecf304be87ea5a7cd4d1a4a93670a404">  134</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#aecf304be87ea5a7cd4d1a4a93670a404">ChunkCompute</a>(</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> chunk_row_offset,</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        <a class="code hl_typedef" href="params_8h.html#aae0a4301a15974d8514ee65bcd2f78c5">input_char_block_t</a> &amp;query,</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;reference)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        <a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;init_col_scr,</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        hls::vector&lt;type_t, N_LAYERS&gt; (&amp;init_row_scr)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        <span class="keywordtype">int</span> query_length, <span class="keywordtype">int</span> reference_length,</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        hls::vector&lt;type_t, N_LAYERS&gt; (&amp;preserved_row_scr)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        <a class="code hl_struct" href="structScorePack.html">ScorePack</a> &amp;max,  <span class="comment">// write out so must pass by reference</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        hls::vector&lt;tbp_t, N_LAYERS&gt; (*chunk_tbp_out)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>]</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    );</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno"><a class="line" href="namespaceAlign.html#af7f2171dda71f8dfed5e8d74fadd7357">  146</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#af7f2171dda71f8dfed5e8d74fadd7357">WriteInitialColScore</a>(<span class="keywordtype">int</span> i, <a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a> (&amp;init_scores)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        hls::stream_of_blocks&lt;dp_mem_block_t&gt; &amp;dp_mem_in,</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        hls::stream_of_blocks&lt;dp_mem_block_t&gt; &amp;scores_out);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a8d0a95360406020075f4199acd400897">  150</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a8d0a95360406020075f4199acd400897">ArrangeTBPBlock</a>(</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>        hls::stream_of_blocks&lt;tbp_block_t&gt; &amp;tbp_in,</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordtype">bool</span> (&amp;predicate)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> (&amp;pe_offset)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>],</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        hls::stream_of_blocks&lt;tbp_chunk_block_t&gt; &amp;tbp_chunk_out</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    );</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a09c7508402d3fb17a15436a84c76e82f">  156</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a09c7508402d3fb17a15436a84c76e82f">ArrangeTBPArr</a>(</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        <a class="code hl_typedef" href="params_8h.html#aa933d2cb25ab26a8ffbe600bf9689eae">tbp_block_t</a> &amp;tbp_in,</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        <span class="keywordtype">bool</span> (&amp;predicate)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> (&amp;pe_offset)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>],</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        hls::vector&lt;tbp_t, N_LAYERS&gt; (*chunk_tbp_out)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>]</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    );</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a304682b6f53cdf1158928d8aa253248b">  162</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a304682b6f53cdf1158928d8aa253248b">ShiftPredicate</a>(<span class="keywordtype">bool</span> (&amp;predicate)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> query_len, <span class="keywordtype">int</span> reference_len); </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="namespaceAlign.html#afb3d6ba48368d71c9a9b913f6250d458">  164</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#afb3d6ba48368d71c9a9b913f6250d458">ShiftReferece</a>(</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;local_reference)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;reference)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> ref_len</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    );</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a8a8c293ec21ce1c762d45f0b20a587ea">  169</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a8a8c293ec21ce1c762d45f0b20a587ea">PreserveRowScore</a>(</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        hls::vector&lt;type_t, N_LAYERS&gt; (&amp;preserved_row_scr)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        <a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;scores,</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        <span class="keywordtype">bool</span> (&amp;predicate)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> (&amp;pe_offset)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>]</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    );</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="foldopen" id="foldopen00176" data-start="{" data-end="}">
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno"><a class="line" href="namespaceAlign_1_1FindMax.html">  176</a></span>    <span class="keyword">namespace </span>FindMax {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <span class="comment">// void UpdateMaximium(</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        <span class="comment">//  idx_t chunk_row_offset,</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        <span class="comment">//  idx_t (&amp;pe_offset)[PE_NUM],</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="comment">//  bool (&amp;predicate)[PE_NUM],</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        <span class="comment">//  ScorePack (&amp;max)[PE_NUM],</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        <span class="comment">//  score_block_t &amp;scores</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        <span class="comment">// );</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="namespaceAlign_1_1FindMax.html#ab2634436f46741c9a5f027bf3238801a">  185</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign_1_1FindMax.html#ab2634436f46741c9a5f027bf3238801a">UpdatePEMaximum</a>(<a class="code hl_typedef" href="params_8h.html#ab854c148395db761c5fe6c171946ee9a">type_t</a> (&amp;new_scr)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <a class="code hl_struct" href="structScorePack.html">ScorePack</a> (&amp;max)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> (&amp;pe_offsets)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> chunk_offset, <span class="keywordtype">bool</span> (&amp;predicate)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>]);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno"><a class="line" href="namespaceAlign_1_1FindMax.html#aff2228f04fe7f30946256045ca7c7ce3">  187</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign_1_1FindMax.html#aff2228f04fe7f30946256045ca7c7ce3">ExtractScoresLayer</a>(<a class="code hl_typedef" href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a> &amp;scores, <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> layer, <a class="code hl_typedef" href="params_8h.html#ab854c148395db761c5fe6c171946ee9a">type_t</a> (&amp;extracted)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>]);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="namespaceAlign_1_1FindMax.html#a6ad6db830b72334397e356a3a847e0f0">  189</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign_1_1FindMax.html#a6ad6db830b72334397e356a3a847e0f0">InitPE</a>(<a class="code hl_struct" href="structScorePack.html">ScorePack</a> (&amp;packs)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>]);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno"><a class="line" href="namespaceAlign_1_1FindMax.html#a0b945e05f4e77473debeabd5bcbe2f3a">  191</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign_1_1FindMax.html#a0b945e05f4e77473debeabd5bcbe2f3a">GetChunkMax</a>(<a class="code hl_struct" href="structScorePack.html">ScorePack</a> (&amp;max)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <a class="code hl_struct" href="structScorePack.html">ScorePack</a> &amp;chunk_max);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <span class="comment">// void ChunkMaximium();</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        <span class="comment">// void Sender ()  // Used to send the scores out the compute logic by blocks to find the max. Implement in the future</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    };</div>
</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a72287740d9a7894f0532e38049c1a506">  207</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a72287740d9a7894f0532e38049c1a506">AlignStatic</a>(</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;querys)[<a class="code hl_define" href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a>],</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <a class="code hl_typedef" href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a> (&amp;references)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> query_length,</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        <a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> reference_length,</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        <a class="code hl_typedef" href="params_8h.html#a904688672ad769b7683603c2edeabd2b">tbp_t</a> (&amp;tb_streams)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a> + <a class="code hl_define" href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a>]</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    );</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno"><a class="line" href="namespaceAlign.html#ae52f8a1e49b3cb69233a7e46c2bc725a">  222</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#ae52f8a1e49b3cb69233a7e46c2bc725a">InitializeScores</a>(</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>        <a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a> (&amp;init_col_scr)[<a class="code hl_define" href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a>],</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        <a class="code hl_typedef" href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a> (&amp;init_row_scr)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>]</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    );</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a781303e36556d883c4e05dd7e877a973">  227</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a781303e36556d883c4e05dd7e877a973">ChunkMax</a>(<a class="code hl_struct" href="structScorePack.html">ScorePack</a> &amp;max, <a class="code hl_struct" href="structScorePack.html">ScorePack</a> new_scr);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a80fd5bb4d0fa5d05c7e4d18868b7b998">  229</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a80fd5bb4d0fa5d05c7e4d18868b7b998">UpdatePEOffset</a>(<a class="code hl_typedef" href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a> (&amp;pe_offset)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>], <span class="keywordtype">bool</span> (&amp;predicate)[<a class="code hl_define" href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a>]);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno"><a class="line" href="namespaceAlign.html#a60510cbc481b21348a81ab61e665c8d4">  231</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceAlign.html#a60510cbc481b21348a81ab61e665c8d4">Traceback</a>(</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        hls::vector&lt;tbp_t, N_LAYERS&gt; (&amp;tbmat)[<a class="code hl_define" href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a>][<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>],</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        <a class="code hl_typedef" href="params_8h.html#a904688672ad769b7683603c2edeabd2b">tbp_t</a> (&amp;traceback_out)[<a class="code hl_define" href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a>+<a class="code hl_define" href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a>],</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> max_row, <span class="keyword">const</span> <span class="keywordtype">int</span> max_col, <span class="keyword">const</span> <span class="keywordtype">int</span> max_layer);  <span class="comment">// starting index to traceback</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>}</div>
</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span><span class="preprocessor">#endif </span><span class="comment">// !SEQ_ALIGN_H</span></div>
<div class="ttc" id="aPE_8h_html"><div class="ttname"><a href="PE_8h.html">PE.h</a></div></div>
<div class="ttc" id="adebug_8h_html"><div class="ttname"><a href="debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="ainitial_8h_html"><div class="ttname"><a href="initial_8h.html">initial.h</a></div></div>
<div class="ttc" id="anamespaceAlign_1_1FindMax_html_a0b945e05f4e77473debeabd5bcbe2f3a"><div class="ttname"><a href="namespaceAlign_1_1FindMax.html#a0b945e05f4e77473debeabd5bcbe2f3a">Align::FindMax::GetChunkMax</a></div><div class="ttdeci">void GetChunkMax(ScorePack(&amp;max)[PE_NUM], ScorePack &amp;chunk_max)</div></div>
<div class="ttc" id="anamespaceAlign_1_1FindMax_html_a6ad6db830b72334397e356a3a847e0f0"><div class="ttname"><a href="namespaceAlign_1_1FindMax.html#a6ad6db830b72334397e356a3a847e0f0">Align::FindMax::InitPE</a></div><div class="ttdeci">void InitPE(ScorePack(&amp;packs)[PE_NUM])</div></div>
<div class="ttc" id="anamespaceAlign_1_1FindMax_html_ab2634436f46741c9a5f027bf3238801a"><div class="ttname"><a href="namespaceAlign_1_1FindMax.html#ab2634436f46741c9a5f027bf3238801a">Align::FindMax::UpdatePEMaximum</a></div><div class="ttdeci">void UpdatePEMaximum(type_t(&amp;new_scr)[PE_NUM], ScorePack(&amp;max)[PE_NUM], idx_t(&amp;pe_offsets)[PE_NUM], idx_t chunk_offset, bool(&amp;predicate)[PE_NUM])</div></div>
<div class="ttc" id="anamespaceAlign_1_1FindMax_html_aff2228f04fe7f30946256045ca7c7ce3"><div class="ttname"><a href="namespaceAlign_1_1FindMax.html#aff2228f04fe7f30946256045ca7c7ce3">Align::FindMax::ExtractScoresLayer</a></div><div class="ttdeci">void ExtractScoresLayer(score_block_t &amp;scores, idx_t layer, type_t(&amp;extracted)[PE_NUM])</div></div>
<div class="ttc" id="anamespaceAlign_html"><div class="ttname"><a href="namespaceAlign.html">Align</a></div><div class="ttdef"><b>Definition</b> seq_align.h:41</div></div>
<div class="ttc" id="anamespaceAlign_html_a09c7508402d3fb17a15436a84c76e82f"><div class="ttname"><a href="namespaceAlign.html#a09c7508402d3fb17a15436a84c76e82f">Align::ArrangeTBPArr</a></div><div class="ttdeci">void ArrangeTBPArr(tbp_block_t &amp;tbp_in, bool(&amp;predicate)[PE_NUM], idx_t(&amp;pe_offset)[PE_NUM], hls::vector&lt; tbp_t, N_LAYERS &gt;(*chunk_tbp_out)[MAX_REFERENCE_LENGTH])</div></div>
<div class="ttc" id="anamespaceAlign_html_a304682b6f53cdf1158928d8aa253248b"><div class="ttname"><a href="namespaceAlign.html#a304682b6f53cdf1158928d8aa253248b">Align::ShiftPredicate</a></div><div class="ttdeci">void ShiftPredicate(bool(&amp;predicate)[PE_NUM], int idx, int query_len, int reference_len)</div></div>
<div class="ttc" id="anamespaceAlign_html_a57bde59190c2570050f6ed9e3041d8c3"><div class="ttname"><a href="namespaceAlign.html#a57bde59190c2570050f6ed9e3041d8c3">Align::PrepareLocalQuery</a></div><div class="ttdeci">void PrepareLocalQuery(char_t(&amp;query)[MAX_QUERY_LENGTH], char_t(&amp;local_query)[PE_NUM], idx_t offset, idx_t len)</div><div class="ttdoc">Copy PE_NUM number of query values to the local query buffer.</div></div>
<div class="ttc" id="anamespaceAlign_html_a60510cbc481b21348a81ab61e665c8d4"><div class="ttname"><a href="namespaceAlign.html#a60510cbc481b21348a81ab61e665c8d4">Align::Traceback</a></div><div class="ttdeci">void Traceback(hls::vector&lt; tbp_t, N_LAYERS &gt;(&amp;tbmat)[MAX_QUERY_LENGTH][MAX_REFERENCE_LENGTH], tbp_t(&amp;traceback_out)[MAX_REFERENCE_LENGTH+MAX_QUERY_LENGTH], const int max_row, const int max_col, const int max_layer)</div></div>
<div class="ttc" id="anamespaceAlign_html_a72287740d9a7894f0532e38049c1a506"><div class="ttname"><a href="namespaceAlign.html#a72287740d9a7894f0532e38049c1a506">Align::AlignStatic</a></div><div class="ttdeci">void AlignStatic(char_t(&amp;querys)[MAX_QUERY_LENGTH], char_t(&amp;references)[MAX_REFERENCE_LENGTH], idx_t query_length, idx_t reference_length, tbp_t(&amp;tb_streams)[MAX_REFERENCE_LENGTH+MAX_QUERY_LENGTH])</div><div class="ttdoc">Perform Pairwise alignment for two sequences.</div></div>
<div class="ttc" id="anamespaceAlign_html_a781303e36556d883c4e05dd7e877a973"><div class="ttname"><a href="namespaceAlign.html#a781303e36556d883c4e05dd7e877a973">Align::ChunkMax</a></div><div class="ttdeci">void ChunkMax(ScorePack &amp;max, ScorePack new_scr)</div></div>
<div class="ttc" id="anamespaceAlign_html_a7cbd554ea3395dc97f0255277f885f17"><div class="ttname"><a href="namespaceAlign.html#a7cbd554ea3395dc97f0255277f885f17">Align::DPMemUpdateBlock</a></div><div class="ttdeci">void DPMemUpdateBlock(hls::stream_of_blocks&lt; dp_mem_block_t &gt; &amp;dp_mem_in, hls::stream_of_blocks&lt; score_block_t &gt; &amp;score_in, hls::stream_of_blocks&lt; dp_mem_block_t &gt; &amp;dp_mem_out)</div></div>
<div class="ttc" id="anamespaceAlign_html_a80fd5bb4d0fa5d05c7e4d18868b7b998"><div class="ttname"><a href="namespaceAlign.html#a80fd5bb4d0fa5d05c7e4d18868b7b998">Align::UpdatePEOffset</a></div><div class="ttdeci">void UpdatePEOffset(idx_t(&amp;pe_offset)[PE_NUM], bool(&amp;predicate)[PE_NUM])</div></div>
<div class="ttc" id="anamespaceAlign_html_a8a8c293ec21ce1c762d45f0b20a587ea"><div class="ttname"><a href="namespaceAlign.html#a8a8c293ec21ce1c762d45f0b20a587ea">Align::PreserveRowScore</a></div><div class="ttdeci">void PreserveRowScore(hls::vector&lt; type_t, N_LAYERS &gt;(&amp;preserved_row_scr)[MAX_REFERENCE_LENGTH], score_block_t &amp;scores, bool(&amp;predicate)[PE_NUM], idx_t(&amp;pe_offset)[PE_NUM])</div></div>
<div class="ttc" id="anamespaceAlign_html_a8d0a95360406020075f4199acd400897"><div class="ttname"><a href="namespaceAlign.html#a8d0a95360406020075f4199acd400897">Align::ArrangeTBPBlock</a></div><div class="ttdeci">void ArrangeTBPBlock(hls::stream_of_blocks&lt; tbp_block_t &gt; &amp;tbp_in, bool(&amp;predicate)[PE_NUM], idx_t(&amp;pe_offset)[PE_NUM], hls::stream_of_blocks&lt; tbp_chunk_block_t &gt; &amp;tbp_chunk_out)</div></div>
<div class="ttc" id="anamespaceAlign_html_acf68c99ac0164bdebf1c6c2f0c44a32b"><div class="ttname"><a href="namespaceAlign.html#acf68c99ac0164bdebf1c6c2f0c44a32b">Align::PrepareScoresBlock</a></div><div class="ttdeci">void PrepareScoresBlock(hls::stream_of_blocks&lt; dp_mem_block_t &gt; &amp;dp_mem_in, score_vec_t(&amp;init_col_scr)[PE_NUM], int id, hls::stream_of_blocks&lt; score_vec_t[2]&gt; &amp;last_chunk_scr, hls::stream_of_blocks&lt; score_block_t &gt; &amp;up_out, hls::stream_of_blocks&lt; score_block_t &gt; &amp;diag_out, hls::stream_of_blocks&lt; score_block_t &gt; &amp;left_out, hls::stream_of_blocks&lt; dp_mem_block_t &gt; &amp;dp_mem_out)</div><div class="ttdoc">Prepare blocks of left, up, an diagonal scores for ExpandComputeBlock function.</div></div>
<div class="ttc" id="anamespaceAlign_html_add7b97d2ce15372695f3a50937d9ca0e"><div class="ttname"><a href="namespaceAlign.html#add7b97d2ce15372695f3a50937d9ca0e">Align::ChunkComputeBlock</a></div><div class="ttdeci">void ChunkComputeBlock(idx_t chunk_row_offset, input_char_block_t &amp;query, char_t(&amp;reference)[MAX_REFERENCE_LENGTH], score_block_t &amp;init_col_scr, hls::vector&lt; type_t, N_LAYERS &gt;(&amp;init_row_scr)[MAX_REFERENCE_LENGTH], int query_length, int reference_length, hls::vector&lt; type_t, N_LAYERS &gt;(&amp;preserved_row_scr)[MAX_REFERENCE_LENGTH], ScorePack &amp;max, hls::stream_of_blocks&lt; tbp_chunk_block_t &gt; &amp;chunk_tbp_out)</div><div class="ttdoc">Compute a chunk of the alignment matrix. Output the chunk traceback pointers.</div></div>
<div class="ttc" id="anamespaceAlign_html_adfd9ea4e4f4a3a398239fb53c3f0d574"><div class="ttname"><a href="namespaceAlign.html#adfd9ea4e4f4a3a398239fb53c3f0d574">Align::PrepareScoresArr</a></div><div class="ttdeci">void PrepareScoresArr(dp_mem_block_t &amp;dp_mem_in, score_vec_t(&amp;init_col_scr)[PE_NUM], int id, score_vec_t(&amp;last_chunk_scr)[2], score_block_t &amp;up_out, score_block_t &amp;diag_out, score_block_t &amp;left_out)</div></div>
<div class="ttc" id="anamespaceAlign_html_ae52f8a1e49b3cb69233a7e46c2bc725a"><div class="ttname"><a href="namespaceAlign.html#ae52f8a1e49b3cb69233a7e46c2bc725a">Align::InitializeScores</a></div><div class="ttdeci">void InitializeScores(score_vec_t(&amp;init_col_scr)[MAX_QUERY_LENGTH], score_vec_t(&amp;init_row_scr)[MAX_REFERENCE_LENGTH])</div><div class="ttdoc">Initialize initial scores for the first column and row on the device.</div></div>
<div class="ttc" id="anamespaceAlign_html_aecf304be87ea5a7cd4d1a4a93670a404"><div class="ttname"><a href="namespaceAlign.html#aecf304be87ea5a7cd4d1a4a93670a404">Align::ChunkCompute</a></div><div class="ttdeci">void ChunkCompute(idx_t chunk_row_offset, input_char_block_t &amp;query, char_t(&amp;reference)[MAX_REFERENCE_LENGTH], score_block_t &amp;init_col_scr, hls::vector&lt; type_t, N_LAYERS &gt;(&amp;init_row_scr)[MAX_REFERENCE_LENGTH], int query_length, int reference_length, hls::vector&lt; type_t, N_LAYERS &gt;(&amp;preserved_row_scr)[MAX_REFERENCE_LENGTH], ScorePack &amp;max, hls::vector&lt; tbp_t, N_LAYERS &gt;(*chunk_tbp_out)[MAX_REFERENCE_LENGTH])</div><div class="ttdoc">Compute the traceback pointers for a chunk of the size PE_NUM * REFERENCE_LENGTH.</div></div>
<div class="ttc" id="anamespaceAlign_html_af119b9ad38057b15d433eb269ef1cda3"><div class="ttname"><a href="namespaceAlign.html#af119b9ad38057b15d433eb269ef1cda3">Align::DPMemUpdateArr</a></div><div class="ttdeci">void DPMemUpdateArr(dp_mem_block_t &amp;dp_mem_in, score_block_t &amp;score_in)</div></div>
<div class="ttc" id="anamespaceAlign_html_af54cccdb98b3f84f0bd2b9baef141568"><div class="ttname"><a href="namespaceAlign.html#af54cccdb98b3f84f0bd2b9baef141568">Align::InitializeChunkColScore</a></div><div class="ttdeci">void InitializeChunkColScore(score_vec_t(&amp;init_col_scr)[PE_NUM], stream_of_blocks&lt; dp_mem_block_t &gt; &amp;dp_mem_out)</div></div>
<div class="ttc" id="anamespaceAlign_html_af7f2171dda71f8dfed5e8d74fadd7357"><div class="ttname"><a href="namespaceAlign.html#af7f2171dda71f8dfed5e8d74fadd7357">Align::WriteInitialColScore</a></div><div class="ttdeci">void WriteInitialColScore(int i, score_vec_t(&amp;init_scores)[PE_NUM], hls::stream_of_blocks&lt; dp_mem_block_t &gt; &amp;dp_mem_in, hls::stream_of_blocks&lt; dp_mem_block_t &gt; &amp;scores_out)</div></div>
<div class="ttc" id="anamespaceAlign_html_afb3d6ba48368d71c9a9b913f6250d458"><div class="ttname"><a href="namespaceAlign.html#afb3d6ba48368d71c9a9b913f6250d458">Align::ShiftReferece</a></div><div class="ttdeci">void ShiftReferece(char_t(&amp;local_reference)[PE_NUM], char_t(&amp;reference)[MAX_REFERENCE_LENGTH], int idx, int ref_len)</div></div>
<div class="ttc" id="aparams_8h_html"><div class="ttname"><a href="params_8h.html">params.h</a></div></div>
<div class="ttc" id="aparams_8h_html_a0083a9bee1ec159ad13954a3186ef6d9"><div class="ttname"><a href="params_8h.html#a0083a9bee1ec159ad13954a3186ef6d9">MAX_REFERENCE_LENGTH</a></div><div class="ttdeci">#define MAX_REFERENCE_LENGTH</div><div class="ttdef"><b>Definition</b> params.h:362</div></div>
<div class="ttc" id="aparams_8h_html_a0deac85b32dbd3d91a713912fa616412"><div class="ttname"><a href="params_8h.html#a0deac85b32dbd3d91a713912fa616412">idx_t</a></div><div class="ttdeci">ap_uint&lt; 8 &gt; idx_t</div><div class="ttdef"><b>Definition</b> params.h:390</div></div>
<div class="ttc" id="aparams_8h_html_a5c792b933d6f003bb1c5e08e940319ba"><div class="ttname"><a href="params_8h.html#a5c792b933d6f003bb1c5e08e940319ba">score_block_t</a></div><div class="ttdeci">hls::vector&lt; type_t, N_LAYERS &gt; score_block_t[PE_NUM]</div><div class="ttdef"><b>Definition</b> params.h:429</div></div>
<div class="ttc" id="aparams_8h_html_a8f04d03e80ec19dc2f6f36097e3f8202"><div class="ttname"><a href="params_8h.html#a8f04d03e80ec19dc2f6f36097e3f8202">MAX_QUERY_LENGTH</a></div><div class="ttdeci">#define MAX_QUERY_LENGTH</div><div class="ttdef"><b>Definition</b> params.h:361</div></div>
<div class="ttc" id="aparams_8h_html_a904688672ad769b7683603c2edeabd2b"><div class="ttname"><a href="params_8h.html#a904688672ad769b7683603c2edeabd2b">tbp_t</a></div><div class="ttdeci">ap_ufixed&lt; WT, IT &gt; tbp_t</div><div class="ttdef"><b>Definition</b> params.h:391</div></div>
<div class="ttc" id="aparams_8h_html_aa933d2cb25ab26a8ffbe600bf9689eae"><div class="ttname"><a href="params_8h.html#aa933d2cb25ab26a8ffbe600bf9689eae">tbp_block_t</a></div><div class="ttdeci">hls::vector&lt; tbp_t, N_LAYERS &gt; tbp_block_t[PE_NUM]</div><div class="ttdef"><b>Definition</b> params.h:430</div></div>
<div class="ttc" id="aparams_8h_html_aae0a4301a15974d8514ee65bcd2f78c5"><div class="ttname"><a href="params_8h.html#aae0a4301a15974d8514ee65bcd2f78c5">input_char_block_t</a></div><div class="ttdeci">char_t input_char_block_t[PE_NUM]</div><div class="ttdef"><b>Definition</b> params.h:431</div></div>
<div class="ttc" id="aparams_8h_html_ab854c148395db761c5fe6c171946ee9a"><div class="ttname"><a href="params_8h.html#ab854c148395db761c5fe6c171946ee9a">type_t</a></div><div class="ttdeci">ap_fixed&lt; MT, NT &gt; type_t</div><div class="ttdef"><b>Definition</b> params.h:389</div></div>
<div class="ttc" id="aparams_8h_html_ac7cce7368348bd25ead6f536eb2e9851"><div class="ttname"><a href="params_8h.html#ac7cce7368348bd25ead6f536eb2e9851">char_t</a></div><div class="ttdeci">ap_uint&lt; 3 &gt; char_t</div><div class="ttdef"><b>Definition</b> params.h:388</div></div>
<div class="ttc" id="aparams_8h_html_aceb4cc72bd33675b648bc2c8c1f7886b"><div class="ttname"><a href="params_8h.html#aceb4cc72bd33675b648bc2c8c1f7886b">PE_NUM</a></div><div class="ttdeci">#define PE_NUM</div><div class="ttdef"><b>Definition</b> params.h:364</div></div>
<div class="ttc" id="aparams_8h_html_ad3fad65c31308e9db74520d3fa260ff0"><div class="ttname"><a href="params_8h.html#ad3fad65c31308e9db74520d3fa260ff0">score_vec_t</a></div><div class="ttdeci">hls::vector&lt; type_t, N_LAYERS &gt; score_vec_t</div><div class="ttdef"><b>Definition</b> params.h:435</div></div>
<div class="ttc" id="aparams_8h_html_ae4f28926330c68480c3d77d49137e189"><div class="ttname"><a href="params_8h.html#ae4f28926330c68480c3d77d49137e189">dp_mem_block_t</a></div><div class="ttdeci">hls::vector&lt; type_t, N_LAYERS &gt; dp_mem_block_t[2][PE_NUM]</div><div class="ttdef"><b>Definition</b> params.h:432</div></div>
<div class="ttc" id="aseq__align_8h_html_a76b44c4299f98b78c420f98497d478e4"><div class="ttname"><a href="seq__align_8h.html#a76b44c4299f98b78c420f98497d478e4">align_wp</a></div><div class="ttdeci">void align_wp(hls::stream&lt; char_t, MAX_QUERY_LENGTH &gt; &amp;query_stream, hls::stream&lt; char_t, MAX_REFERENCE_LENGTH &gt; &amp;reference_stream, hls::stream&lt; hls::vector&lt; type_t, N_LAYERS &gt;, MAX_QUERY_LENGTH &gt; &amp;init_qry_scr, hls::stream&lt; hls::vector&lt; type_t, N_LAYERS &gt;, MAX_REFERENCE_LENGTH &gt; &amp;init_ref_scr, hls::stream&lt; tbp_t, MAX_REFERENCE_LENGTH+MAX_QUERY_LENGTH &gt; &amp;traceback_out)</div></div>
<div class="ttc" id="astructScorePack_html"><div class="ttname"><a href="structScorePack.html">ScorePack</a></div><div class="ttdef"><b>Definition</b> params.h:452</div></div>
<div class="ttc" id="autils_8h_html"><div class="ttname"><a href="utils_8h.html">utils.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
