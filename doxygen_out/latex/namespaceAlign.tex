\doxysection{Align Namespace Reference}
\hypertarget{namespaceAlign}{}\label{namespaceAlign}\index{Align@{Align}}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespaceAlign_1_1FindMax}{Find\+Max}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{namespaceAlign_a57bde59190c2570050f6ed9e3041d8c3}{Prepare\+Local\+Query}} (\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&query)\mbox{[}\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&local\+\_\+query)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} offset, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} len)
\begin{DoxyCompactList}\small\item\em Copy PE\+\_\+\+NUM number of query values to the local query buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_a7cbd554ea3395dc97f0255277f885f17}{DPMem\+Update\+Block}} (hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+in, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&score\+\_\+in, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_af119b9ad38057b15d433eb269ef1cda3}{DPMem\+Update\+Arr}} (\mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} \&dp\+\_\+mem\+\_\+in, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&score\+\_\+in)
\item 
void \mbox{\hyperlink{namespaceAlign_af54cccdb98b3f84f0bd2b9baef141568}{Initialize\+Chunk\+Col\+Score}} (\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_acf68c99ac0164bdebf1c6c2f0c44a32b}{Prepare\+Scores\+Block}} (hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+in, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, int id, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}\mbox{[}2\mbox{]}$>$ \&last\+\_\+chunk\+\_\+scr, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&up\+\_\+out, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&diag\+\_\+out, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&left\+\_\+out, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+out)
\begin{DoxyCompactList}\small\item\em Prepare blocks of left, up, an diagonal scores for Expand\+Compute\+Block function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_adfd9ea4e4f4a3a398239fb53c3f0d574}{Prepare\+Scores\+Arr}} (\mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} \&dp\+\_\+mem\+\_\+in, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, int id, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&last\+\_\+chunk\+\_\+scr)\mbox{[}2\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&up\+\_\+out, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&diag\+\_\+out, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&left\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_add7b97d2ce15372695f3a50937d9ca0e}{Chunk\+Compute\+Block}} (\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} chunk\+\_\+row\+\_\+offset, \mbox{\hyperlink{params_8h_aae0a4301a15974d8514ee65bcd2f78c5}{input\+\_\+char\+\_\+block\+\_\+t}} \&query, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&reference)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&init\+\_\+col\+\_\+scr, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&init\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, int query\+\_\+length, int reference\+\_\+length, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&preserved\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{structScorePack}{Score\+Pack}} \&max, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_aaf7c6485e3271a08bbfa8a60052aadfc}{tbp\+\_\+chunk\+\_\+block\+\_\+t}} $>$ \&chunk\+\_\+tbp\+\_\+out)
\begin{DoxyCompactList}\small\item\em Compute a chunk of the alignment matrix. Output the chunk traceback pointers. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_aecf304be87ea5a7cd4d1a4a93670a404}{Chunk\+Compute}} (\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} chunk\+\_\+row\+\_\+offset, \mbox{\hyperlink{params_8h_aae0a4301a15974d8514ee65bcd2f78c5}{input\+\_\+char\+\_\+block\+\_\+t}} \&query, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&reference)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&init\+\_\+col\+\_\+scr, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&init\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, int query\+\_\+length, int reference\+\_\+length, hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&preserved\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{structScorePack}{Score\+Pack}} \&max, hls\+::vector$<$ \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\texorpdfstring{$\ast$}{*}chunk\+\_\+tbp\+\_\+out)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Compute the traceback pointers for a chunk of the size PE\+\_\+\+NUM \texorpdfstring{$\ast$}{*} REFERENCE\+\_\+\+LENGTH. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_af7f2171dda71f8dfed5e8d74fadd7357}{Write\+Initial\+Col\+Score}} (int i, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+scores)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&dp\+\_\+mem\+\_\+in, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&scores\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_a8d0a95360406020075f4199acd400897}{Arrange\+TBPBlock}} (hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_aa933d2cb25ab26a8ffbe600bf9689eae}{tbp\+\_\+block\+\_\+t}} $>$ \&tbp\+\_\+in, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_aaf7c6485e3271a08bbfa8a60052aadfc}{tbp\+\_\+chunk\+\_\+block\+\_\+t}} $>$ \&tbp\+\_\+chunk\+\_\+out)
\item 
void \mbox{\hyperlink{namespaceAlign_a09c7508402d3fb17a15436a84c76e82f}{Arrange\+TBPArr}} (\mbox{\hyperlink{params_8h_aa933d2cb25ab26a8ffbe600bf9689eae}{tbp\+\_\+block\+\_\+t}} \&tbp\+\_\+in, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, hls\+::vector$<$ \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\texorpdfstring{$\ast$}{*}chunk\+\_\+tbp\+\_\+out)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_a304682b6f53cdf1158928d8aa253248b}{Shift\+Predicate}} (bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, int idx, int query\+\_\+len, int reference\+\_\+len)
\item 
void \mbox{\hyperlink{namespaceAlign_afb3d6ba48368d71c9a9b913f6250d458}{Shift\+Referece}} (\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&local\+\_\+reference)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&reference)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, int idx, int ref\+\_\+len)
\item 
void \mbox{\hyperlink{namespaceAlign_a8a8c293ec21ce1c762d45f0b20a587ea}{Preserve\+Row\+Score}} (hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&preserved\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&scores, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_a72287740d9a7894f0532e38049c1a506}{Align\+Static}} (\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&querys)\mbox{[}\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&references)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} query\+\_\+length, \mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}} reference\+\_\+length, \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}(\&tb\+\_\+streams)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}+\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Perform Pairwise alignment for two sequences. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_ae52f8a1e49b3cb69233a7e46c2bc725a}{Initialize\+Scores}} (\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+col\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&init\+\_\+row\+\_\+scr)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Initialize initial scores for the first column and row on the device. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespaceAlign_a781303e36556d883c4e05dd7e877a973}{Chunk\+Max}} (\mbox{\hyperlink{structScorePack}{Score\+Pack}} \&max, \mbox{\hyperlink{structScorePack}{Score\+Pack}} new\+\_\+scr)
\item 
void \mbox{\hyperlink{namespaceAlign_a80fd5bb4d0fa5d05c7e4d18868b7b998}{Update\+PEOffset}} (\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&pe\+\_\+offset)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]}, bool(\&predicate)\mbox{[}\mbox{\hyperlink{params_8h_aceb4cc72bd33675b648bc2c8c1f7886b}{PE\+\_\+\+NUM}}\mbox{]})
\item 
void \mbox{\hyperlink{namespaceAlign_a60510cbc481b21348a81ab61e665c8d4}{Traceback}} (hls\+::vector$<$ \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&tbmat)\mbox{[}\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}\mbox{]}, \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}(\&traceback\+\_\+out)\mbox{[}\mbox{\hyperlink{params_8h_a0083a9bee1ec159ad13954a3186ef6d9}{MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH}}+\mbox{\hyperlink{params_8h_a8f04d03e80ec19dc2f6f36097e3f8202}{MAX\+\_\+\+QUERY\+\_\+\+LENGTH}}\mbox{]}, const int max\+\_\+row, const int max\+\_\+col, const int max\+\_\+layer)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{namespaceAlign_a72287740d9a7894f0532e38049c1a506}\label{namespaceAlign_a72287740d9a7894f0532e38049c1a506} 
\index{Align@{Align}!AlignStatic@{AlignStatic}}
\index{AlignStatic@{AlignStatic}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{AlignStatic()}{AlignStatic()}}
{\footnotesize\ttfamily void Align\+::\+Align\+Static (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{querys\mbox{[}\+MAX\+\_\+\+QUERY\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{references\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}}]{query\+\_\+length,  }\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}}]{reference\+\_\+length,  }\item[{\mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}(\&)}]{tb\+\_\+streams\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH+\+MAX\+\_\+\+QUERY\+\_\+\+LENGTH\mbox{]} }\end{DoxyParamCaption})}



Perform Pairwise alignment for two sequences. 


\begin{DoxyParams}{Parameters}
{\em query} & Query sequence buffer. \\
\hline
{\em reference} & Reference sequence buffer. \\
\hline
{\em query\+\_\+length} & Length of the query. \\
\hline
{\em reference\+\_\+length} & Length of the reference. \\
\hline
{\em tb\+\_\+streams} & Output traceback path. \\
\hline
\end{DoxyParams}
\Hypertarget{namespaceAlign_a09c7508402d3fb17a15436a84c76e82f}\label{namespaceAlign_a09c7508402d3fb17a15436a84c76e82f} 
\index{Align@{Align}!ArrangeTBPArr@{ArrangeTBPArr}}
\index{ArrangeTBPArr@{ArrangeTBPArr}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{ArrangeTBPArr()}{ArrangeTBPArr()}}
{\footnotesize\ttfamily void Align\+::\+Arrange\+TBPArr (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_aa933d2cb25ab26a8ffbe600bf9689eae}{tbp\+\_\+block\+\_\+t}} \&}]{tbp\+\_\+in,  }\item[{bool(\&)}]{predicate\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&)}]{pe\+\_\+offset\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\texorpdfstring{$\ast$}{*})}]{chunk\+\_\+tbp\+\_\+out\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]} }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_a8d0a95360406020075f4199acd400897}\label{namespaceAlign_a8d0a95360406020075f4199acd400897} 
\index{Align@{Align}!ArrangeTBPBlock@{ArrangeTBPBlock}}
\index{ArrangeTBPBlock@{ArrangeTBPBlock}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{ArrangeTBPBlock()}{ArrangeTBPBlock()}}
{\footnotesize\ttfamily void Align\+::\+Arrange\+TBPBlock (\begin{DoxyParamCaption}\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_aa933d2cb25ab26a8ffbe600bf9689eae}{tbp\+\_\+block\+\_\+t}} $>$ \&}]{tbp\+\_\+in,  }\item[{bool(\&)}]{predicate\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&)}]{pe\+\_\+offset\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_aaf7c6485e3271a08bbfa8a60052aadfc}{tbp\+\_\+chunk\+\_\+block\+\_\+t}} $>$ \&}]{tbp\+\_\+chunk\+\_\+out }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_aecf304be87ea5a7cd4d1a4a93670a404}\label{namespaceAlign_aecf304be87ea5a7cd4d1a4a93670a404} 
\index{Align@{Align}!ChunkCompute@{ChunkCompute}}
\index{ChunkCompute@{ChunkCompute}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{ChunkCompute()}{ChunkCompute()}}
{\footnotesize\ttfamily void Align\+::\+Chunk\+Compute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}}]{chunk\+\_\+row\+\_\+offset,  }\item[{\mbox{\hyperlink{params_8h_aae0a4301a15974d8514ee65bcd2f78c5}{input\+\_\+char\+\_\+block\+\_\+t}} \&}]{query,  }\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{reference\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&}]{init\+\_\+col\+\_\+scr,  }\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&)}]{init\+\_\+row\+\_\+scr\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{int}]{query\+\_\+length,  }\item[{int}]{reference\+\_\+length,  }\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&)}]{preserved\+\_\+row\+\_\+scr\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{structScorePack}{Score\+Pack}} \&}]{max,  }\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\texorpdfstring{$\ast$}{*})}]{chunk\+\_\+tbp\+\_\+out\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]} }\end{DoxyParamCaption})}



Compute the traceback pointers for a chunk of the size PE\+\_\+\+NUM \texorpdfstring{$\ast$}{*} REFERENCE\+\_\+\+LENGTH. 


\begin{DoxyParams}{Parameters}
{\em chunk\+\_\+row\+\_\+offset} & \+: The row offset in the whole traceback matrix the beginning of the chunk. \\
\hline
{\em query} & \+: Query sequence with length PE\+\_\+\+NUM. \\
\hline
{\em init\+\_\+col\+\_\+scr} & \+: Initial score for the first column of this chunk. \\
\hline
{\em query\+\_\+length} & \+: Length of the query \texorpdfstring{$<$}{<} PE\+\_\+\+NUM. \\
\hline
{\em reference\+\_\+length} & \+: Length of the reference \texorpdfstring{$<$}{<} MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH. \\
\hline
{\em max} & \+: Score pack of the maximium score of this chunk. \\
\hline
\end{DoxyParams}
\Hypertarget{namespaceAlign_add7b97d2ce15372695f3a50937d9ca0e}\label{namespaceAlign_add7b97d2ce15372695f3a50937d9ca0e} 
\index{Align@{Align}!ChunkComputeBlock@{ChunkComputeBlock}}
\index{ChunkComputeBlock@{ChunkComputeBlock}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{ChunkComputeBlock()}{ChunkComputeBlock()}}
{\footnotesize\ttfamily void Align\+::\+Chunk\+Compute\+Block (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}}]{chunk\+\_\+row\+\_\+offset,  }\item[{\mbox{\hyperlink{params_8h_aae0a4301a15974d8514ee65bcd2f78c5}{input\+\_\+char\+\_\+block\+\_\+t}} \&}]{query,  }\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{reference\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&}]{init\+\_\+col\+\_\+scr,  }\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&)}]{init\+\_\+row\+\_\+scr\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{int}]{query\+\_\+length,  }\item[{int}]{reference\+\_\+length,  }\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&)}]{preserved\+\_\+row\+\_\+scr\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{structScorePack}{Score\+Pack}} \&}]{max,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_aaf7c6485e3271a08bbfa8a60052aadfc}{tbp\+\_\+chunk\+\_\+block\+\_\+t}} $>$ \&}]{chunk\+\_\+tbp\+\_\+out }\end{DoxyParamCaption})}



Compute a chunk of the alignment matrix. Output the chunk traceback pointers. 


\begin{DoxyParams}{Parameters}
{\em query} & \\
\hline
{\em init\+\_\+col\+\_\+scr} & \\
\hline
{\em query\+\_\+length} & \\
\hline
{\em reference\+\_\+length} & \\
\hline
{\em max} & \\
\hline
{\em tbp\+\_\+out} & \\
\hline
\end{DoxyParams}
\Hypertarget{namespaceAlign_a781303e36556d883c4e05dd7e877a973}\label{namespaceAlign_a781303e36556d883c4e05dd7e877a973} 
\index{Align@{Align}!ChunkMax@{ChunkMax}}
\index{ChunkMax@{ChunkMax}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{ChunkMax()}{ChunkMax()}}
{\footnotesize\ttfamily void Align\+::\+Chunk\+Max (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structScorePack}{Score\+Pack}} \&}]{max,  }\item[{\mbox{\hyperlink{structScorePack}{Score\+Pack}}}]{new\+\_\+scr }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_af119b9ad38057b15d433eb269ef1cda3}\label{namespaceAlign_af119b9ad38057b15d433eb269ef1cda3} 
\index{Align@{Align}!DPMemUpdateArr@{DPMemUpdateArr}}
\index{DPMemUpdateArr@{DPMemUpdateArr}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{DPMemUpdateArr()}{DPMemUpdateArr()}}
{\footnotesize\ttfamily void Align\+::\+DPMem\+Update\+Arr (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} \&}]{dp\+\_\+mem\+\_\+in,  }\item[{\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&}]{score\+\_\+in }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_a7cbd554ea3395dc97f0255277f885f17}\label{namespaceAlign_a7cbd554ea3395dc97f0255277f885f17} 
\index{Align@{Align}!DPMemUpdateBlock@{DPMemUpdateBlock}}
\index{DPMemUpdateBlock@{DPMemUpdateBlock}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{DPMemUpdateBlock()}{DPMemUpdateBlock()}}
{\footnotesize\ttfamily void Align\+::\+DPMem\+Update\+Block (\begin{DoxyParamCaption}\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&}]{dp\+\_\+mem\+\_\+in,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&}]{score\+\_\+in,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&}]{dp\+\_\+mem\+\_\+out }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_af54cccdb98b3f84f0bd2b9baef141568}\label{namespaceAlign_af54cccdb98b3f84f0bd2b9baef141568} 
\index{Align@{Align}!InitializeChunkColScore@{InitializeChunkColScore}}
\index{InitializeChunkColScore@{InitializeChunkColScore}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{InitializeChunkColScore()}{InitializeChunkColScore()}}
{\footnotesize\ttfamily void Align\+::\+Initialize\+Chunk\+Col\+Score (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&)}]{init\+\_\+col\+\_\+scr\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&}]{dp\+\_\+mem\+\_\+out }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_ae52f8a1e49b3cb69233a7e46c2bc725a}\label{namespaceAlign_ae52f8a1e49b3cb69233a7e46c2bc725a} 
\index{Align@{Align}!InitializeScores@{InitializeScores}}
\index{InitializeScores@{InitializeScores}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{InitializeScores()}{InitializeScores()}}
{\footnotesize\ttfamily void Align\+::\+Initialize\+Scores (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&)}]{init\+\_\+col\+\_\+scr\mbox{[}\+MAX\+\_\+\+QUERY\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&)}]{init\+\_\+row\+\_\+scr\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]} }\end{DoxyParamCaption})}



Initialize initial scores for the first column and row on the device. 


\begin{DoxyParams}{Parameters}
{\em init\+\_\+col\+\_\+scr} & Initial scores for the first column. \\
\hline
{\em init\+\_\+row\+\_\+scr} & Initial scores for the first row. \\
\hline
\end{DoxyParams}
\Hypertarget{namespaceAlign_a57bde59190c2570050f6ed9e3041d8c3}\label{namespaceAlign_a57bde59190c2570050f6ed9e3041d8c3} 
\index{Align@{Align}!PrepareLocalQuery@{PrepareLocalQuery}}
\index{PrepareLocalQuery@{PrepareLocalQuery}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{PrepareLocalQuery()}{PrepareLocalQuery()}}
{\footnotesize\ttfamily void Align\+::\+Prepare\+Local\+Query (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{query\mbox{[}\+MAX\+\_\+\+QUERY\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{local\+\_\+query\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}}]{offset,  }\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}}]{len }\end{DoxyParamCaption})}



Copy PE\+\_\+\+NUM number of query values to the local query buffer. 


\begin{DoxyParams}{Parameters}
{\em offset} & Offset in the query to copy. \\
\hline
{\em len} & Length to copy. \\
\hline
\end{DoxyParams}
\Hypertarget{namespaceAlign_adfd9ea4e4f4a3a398239fb53c3f0d574}\label{namespaceAlign_adfd9ea4e4f4a3a398239fb53c3f0d574} 
\index{Align@{Align}!PrepareScoresArr@{PrepareScoresArr}}
\index{PrepareScoresArr@{PrepareScoresArr}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{PrepareScoresArr()}{PrepareScoresArr()}}
{\footnotesize\ttfamily void Align\+::\+Prepare\+Scores\+Arr (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} \&}]{dp\+\_\+mem\+\_\+in,  }\item[{\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&)}]{init\+\_\+col\+\_\+scr\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{int}]{id,  }\item[{\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&)}]{last\+\_\+chunk\+\_\+scr\mbox{[}2\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&}]{up\+\_\+out,  }\item[{\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&}]{diag\+\_\+out,  }\item[{\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&}]{left\+\_\+out }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_acf68c99ac0164bdebf1c6c2f0c44a32b}\label{namespaceAlign_acf68c99ac0164bdebf1c6c2f0c44a32b} 
\index{Align@{Align}!PrepareScoresBlock@{PrepareScoresBlock}}
\index{PrepareScoresBlock@{PrepareScoresBlock}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{PrepareScoresBlock()}{PrepareScoresBlock()}}
{\footnotesize\ttfamily void Align\+::\+Prepare\+Scores\+Block (\begin{DoxyParamCaption}\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&}]{dp\+\_\+mem\+\_\+in,  }\item[{\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&)}]{init\+\_\+col\+\_\+scr\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{int}]{id,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}\mbox{[}2\mbox{]}$>$ \&}]{last\+\_\+chunk\+\_\+scr,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&}]{up\+\_\+out,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&}]{diag\+\_\+out,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} $>$ \&}]{left\+\_\+out,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&}]{dp\+\_\+mem\+\_\+out }\end{DoxyParamCaption})}



Prepare blocks of left, up, an diagonal scores for Expand\+Compute\+Block function. 


\begin{DoxyParams}{Parameters}
{\em dp\+\_\+mem\+\_\+in} & DP memory that holds the scores of previous two wavefronts. \\
\hline
{\em last\+\_\+chunk\+\_\+0} & Last row scores from the previous chunk. \\
\hline
{\em last\+\_\+chunk\+\_\+1} & Last row scores from the previous chunk backup. \\
\hline
{\em up\+\_\+out} & Blocks of up scores. \\
\hline
{\em diag\+\_\+out} & Blocks of diagonal scores. \\
\hline
{\em left\+\_\+out} & Blocks of left scores. \\
\hline
\end{DoxyParams}
\Hypertarget{namespaceAlign_a8a8c293ec21ce1c762d45f0b20a587ea}\label{namespaceAlign_a8a8c293ec21ce1c762d45f0b20a587ea} 
\index{Align@{Align}!PreserveRowScore@{PreserveRowScore}}
\index{PreserveRowScore@{PreserveRowScore}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{PreserveRowScore()}{PreserveRowScore()}}
{\footnotesize\ttfamily void Align\+::\+Preserve\+Row\+Score (\begin{DoxyParamCaption}\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_ab854c148395db761c5fe6c171946ee9a}{type\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&)}]{preserved\+\_\+row\+\_\+scr\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a5c792b933d6f003bb1c5e08e940319ba}{score\+\_\+block\+\_\+t}} \&}]{scores,  }\item[{bool(\&)}]{predicate\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&)}]{pe\+\_\+offset\mbox{[}\+PE\+\_\+\+NUM\mbox{]} }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_a304682b6f53cdf1158928d8aa253248b}\label{namespaceAlign_a304682b6f53cdf1158928d8aa253248b} 
\index{Align@{Align}!ShiftPredicate@{ShiftPredicate}}
\index{ShiftPredicate@{ShiftPredicate}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{ShiftPredicate()}{ShiftPredicate()}}
{\footnotesize\ttfamily void Align\+::\+Shift\+Predicate (\begin{DoxyParamCaption}\item[{bool(\&)}]{predicate\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{int}]{idx,  }\item[{int}]{query\+\_\+len,  }\item[{int}]{reference\+\_\+len }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_afb3d6ba48368d71c9a9b913f6250d458}\label{namespaceAlign_afb3d6ba48368d71c9a9b913f6250d458} 
\index{Align@{Align}!ShiftReferece@{ShiftReferece}}
\index{ShiftReferece@{ShiftReferece}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{ShiftReferece()}{ShiftReferece()}}
{\footnotesize\ttfamily void Align\+::\+Shift\+Referece (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{local\+\_\+reference\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_ac7cce7368348bd25ead6f536eb2e9851}{char\+\_\+t}}(\&)}]{reference\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{int}]{idx,  }\item[{int}]{ref\+\_\+len }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_a60510cbc481b21348a81ab61e665c8d4}\label{namespaceAlign_a60510cbc481b21348a81ab61e665c8d4} 
\index{Align@{Align}!Traceback@{Traceback}}
\index{Traceback@{Traceback}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{Traceback()}{Traceback()}}
{\footnotesize\ttfamily void Align\+::\+Traceback (\begin{DoxyParamCaption}\item[{hls\+::vector$<$ \mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}, \mbox{\hyperlink{params_8h_a971dff48b4e712e06083451d36ed5507}{N\+\_\+\+LAYERS}} $>$(\&)}]{tbmat\mbox{[}\+MAX\+\_\+\+QUERY\+\_\+\+LENGTH\mbox{]}\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH\mbox{]},  }\item[{\mbox{\hyperlink{params_8h_a904688672ad769b7683603c2edeabd2b}{tbp\+\_\+t}}(\&)}]{traceback\+\_\+out\mbox{[}\+MAX\+\_\+\+REFERENCE\+\_\+\+LENGTH+\+MAX\+\_\+\+QUERY\+\_\+\+LENGTH\mbox{]},  }\item[{const int}]{max\+\_\+row,  }\item[{const int}]{max\+\_\+col,  }\item[{const int}]{max\+\_\+layer }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_a80fd5bb4d0fa5d05c7e4d18868b7b998}\label{namespaceAlign_a80fd5bb4d0fa5d05c7e4d18868b7b998} 
\index{Align@{Align}!UpdatePEOffset@{UpdatePEOffset}}
\index{UpdatePEOffset@{UpdatePEOffset}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{UpdatePEOffset()}{UpdatePEOffset()}}
{\footnotesize\ttfamily void Align\+::\+Update\+PEOffset (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{params_8h_a0deac85b32dbd3d91a713912fa616412}{idx\+\_\+t}}(\&)}]{pe\+\_\+offset\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{bool(\&)}]{predicate\mbox{[}\+PE\+\_\+\+NUM\mbox{]} }\end{DoxyParamCaption})}

\Hypertarget{namespaceAlign_af7f2171dda71f8dfed5e8d74fadd7357}\label{namespaceAlign_af7f2171dda71f8dfed5e8d74fadd7357} 
\index{Align@{Align}!WriteInitialColScore@{WriteInitialColScore}}
\index{WriteInitialColScore@{WriteInitialColScore}!Align@{Align}}
\doxysubsubsection{\texorpdfstring{WriteInitialColScore()}{WriteInitialColScore()}}
{\footnotesize\ttfamily void Align\+::\+Write\+Initial\+Col\+Score (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{\mbox{\hyperlink{params_8h_ad3fad65c31308e9db74520d3fa260ff0}{score\+\_\+vec\+\_\+t}}(\&)}]{init\+\_\+scores\mbox{[}\+PE\+\_\+\+NUM\mbox{]},  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&}]{dp\+\_\+mem\+\_\+in,  }\item[{hls\+::stream\+\_\+of\+\_\+blocks$<$ \mbox{\hyperlink{params_8h_ae4f28926330c68480c3d77d49137e189}{dp\+\_\+mem\+\_\+block\+\_\+t}} $>$ \&}]{scores\+\_\+out }\end{DoxyParamCaption})}

